
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>变分平均场理论与信念传播算法 &#8212; 神经网络的统计力学（中文笔记）</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">神经网络的统计力学（中文笔记）</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  课程笔记
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cavity-method.html">
   自旋玻璃与空腔方法
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="format.html">
   *技术与排版规范
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/VMFandBP.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   一、引言
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   二、变分自由能
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-field-approximation">
   三、Mean-Field Approximation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bethe-approximation">
   四、Bethe Approximation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     4.1 Bethe Approximation与信念传播算法
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     4.2 一个例子：Bethe Approximation在树状因子图中是精确的
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     4.3 Bethe Approximation与空腔方法的等价性
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bethe-approximationmean-field-approximation">
     4.4 Bethe Approximation与Mean-Field Approximation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     4.5 平均场逆伊辛问题
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   作业
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     1. 关于树状图中Bethe Approximation对应的分布的问题
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#belief-propagationsk-model-c-ij">
     2. 用Belief Propagation求解SK model中的
     <span class="math notranslate nohighlight">
      \(C_{ij}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bethe-approximationinverse-ising-problem">
     3. 用Bethe Approximation求解inverse Ising problem
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   参考文献
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>变分平均场理论与信念传播算法</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   一、引言
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   二、变分自由能
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-field-approximation">
   三、Mean-Field Approximation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bethe-approximation">
   四、Bethe Approximation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     4.1 Bethe Approximation与信念传播算法
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     4.2 一个例子：Bethe Approximation在树状因子图中是精确的
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     4.3 Bethe Approximation与空腔方法的等价性
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bethe-approximationmean-field-approximation">
     4.4 Bethe Approximation与Mean-Field Approximation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     4.5 平均场逆伊辛问题
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   作业
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     1. 关于树状图中Bethe Approximation对应的分布的问题
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#belief-propagationsk-model-c-ij">
     2. 用Belief Propagation求解SK model中的
     <span class="math notranslate nohighlight">
      \(C_{ij}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bethe-approximationinverse-ising-problem">
     3. 用Bethe Approximation求解inverse Ising problem
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   参考文献
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>变分平均场理论与信念传播算法<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<section id="id2">
<h2>一、引言<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>对于一个真实分布</p>
<div class="math notranslate nohighlight">
\[
P(\boldsymbol{x})=\frac{e^{-\beta E(x)}}{Z} \qquad Z=\sum_x e^{-\beta E(x)} \qquad E(\boldsymbol{x})=-\sum_a J_a \prod_{i \in \partial a} x_i
\]</div>
<p>这里采用热力学的写法，将能量写为 <span class="math notranslate nohighlight">\(E(x)\)</span>。</p>
<p>根据 <span class="math notranslate nohighlight">\(Z\)</span> 可以计算Helmholtz自由能 <span class="math notranslate nohighlight">\(F_H=-\ln Z\)</span>，但是 <span class="math notranslate nohighlight">\(Z\)</span> 是 <span class="math notranslate nohighlight">\(\mathcal{O}(N^2)\)</span>，很难直接计算。本节通过构造一个Gibbs自由能 <span class="math notranslate nohighlight">\(F(b)\)</span>（其中 <span class="math notranslate nohighlight">\(b(x)\)</span> 是真实分布，<span class="math notranslate nohighlight">\(F(b)\)</span> 是泛函）并使用变分方法使其逼近真实的Helmholtz自由能 <span class="math notranslate nohighlight">\(F_H=-\ln Z\)</span>。</p>
<p><strong>最大熵规则：</strong>  给定分布的约束下，系统的熵越大，信息量越大，越应该是真实的分布。说明如下：</p>
<p>对于一个未知分布 <span class="math notranslate nohighlight">\(P_r\)</span>，其熵定义为</p>
<div class="math notranslate nohighlight">
\[
S=-k\sum_{r}P_r\ln P_r
\]</div>
<p>该分布要满足归一化和能量守恒（系统的总能量为定值）的约束，即</p>
<div class="math notranslate nohighlight">
\[
\sum_r P_r=1 \qquad \sum_r E_r P_r=\mu
\]</div>
<p>使用拉格朗日乘子法求解约束极值，构造Lagrangian</p>
<div class="math notranslate nohighlight">
\[
L=-k\sum_{r}P_r\ln P_r+\lambda_1\left(\sum_r P_r-1\right)+\lambda_2\left(\sum_r E_r P_r-\mu\right)
\]</div>
<p>取其变分为零</p>
<div class="math notranslate nohighlight">
\[
\frac{\delta L}{\delta P_r}=\sum_{r}\left[-k(\ln P_r+1)+\lambda_1+\lambda_2E_r \right]=0
\]</div>
<p>即</p>
<div class="math notranslate nohighlight">
\[
P_r=\exp\left( -1+\frac{\lambda_1}{k}+\frac{\lambda_2}{k}E_r\right)
\]</div>
<p>代入 <span class="math notranslate nohighlight">\(P_r\)</span> 的归一化条件得</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    &amp;\sum_r P_r=\sum_r \exp\left( -1+\frac{\lambda_1}{k}+\frac{\lambda_2}{k}E_r\right)=1\\
    \Longrightarrow &amp;\exp\left( -1+\frac{\lambda_1}{k}\right)\sum_r \exp\left(\frac{\lambda_2}{k}E_r\right)=1\\
    \Longrightarrow &amp;\exp\left( -1+\frac{\lambda_1}{k}\right)=\frac{1}{\sum_r \exp\left(\frac{\lambda_2}{k}E_r\right)}
\end{aligned}
\end{split}\]</div>
<p>令 <span class="math notranslate nohighlight">\(-\beta \equiv \frac{\lambda_2}{k}\)</span>，因此 <span class="math notranslate nohighlight">\(P_r\)</span> 可写为</p>
<div class="math notranslate nohighlight">
\[
P_r=\frac{\exp\left(-\beta E_r\right)}{\sum_r \exp\left(-\beta E_r\right)}
\]</div>
<p>这正是真实分布中 <span class="math notranslate nohighlight">\(P(\boldsymbol{x})\)</span> 的表达式。</p>
</section>
<section id="id3">
<h2>二、变分自由能<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<p>对于真实分布 <span class="math notranslate nohighlight">\(b(x)\)</span>，Gibbs自由能 <span class="math notranslate nohighlight">\(F(b)\)</span> 是 <span class="math notranslate nohighlight">\(b(x)\)</span> 的泛函，并且设 <span class="math notranslate nohighlight">\(\beta=1\)</span>。在热力学中，Gibbs自由能写为</p>
<div class="math notranslate nohighlight">
\[
F(b)=U(b)-H(b)
\]</div>
<p>其中，<span class="math notranslate nohighlight">\(U(b)\)</span> 是内能；<span class="math notranslate nohighlight">\(H(b)\)</span> 是熵（而不是哈密顿量），他们分别写为</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    &amp;U(b)=\sum_x b(x) E(x) \\
    &amp;H(b)=-\sum_x b(x) \ln b(x)
\end{aligned}
\end{split}\]</div>
<p>所谓的变分自由能就是指我们基于真实分布 <span class="math notranslate nohighlight">\(b(x)\)</span> 构造的Gibbs自由能 <span class="math notranslate nohighlight">\(F(b)\)</span>，因为是用变分的方法去逼近真实的Helmholtz自由能，所以又称为变分自由能。对Gibbs自由能 <span class="math notranslate nohighlight">\(F(b)\)</span> 和Helmholtz自由能 <span class="math notranslate nohighlight">\(F_H\)</span> 作差，得</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
F(b)-F_H &amp;=\sum_{\boldsymbol{x}} b(\boldsymbol{x}) E(\boldsymbol{x})+\sum_{\boldsymbol{x}} b(\boldsymbol{x}) \ln b(\boldsymbol{x})+\ln Z \\
&amp;=\sum_{\boldsymbol{x}} b(\boldsymbol{x})(-\ln Z-\ln P(\boldsymbol{x}))+\sum_{\boldsymbol{x}} b(\boldsymbol{x}) \ln b(\boldsymbol{x})+\ln Z \\
&amp;=\sum_{\boldsymbol{x}} b(\boldsymbol{x}) \ln \frac{b(\boldsymbol{x})}{P(\boldsymbol{x})}=D_{KL}(b \| P)
\end{aligned}
\end{split}\]</div>
<p>其中，第二步用到了由 <span class="math notranslate nohighlight">\(P(\boldsymbol{x})=\frac{e^{- E(\boldsymbol{x})}}{Z}\)</span> 得到的 <span class="math notranslate nohighlight">\(E(\boldsymbol{x})=-\ln Z-\ln P(\boldsymbol{x})\)</span>。可以看到，二者之差为一个KL散度的形式。</p>
<p>**Kullback-Leibler Divergence：  ** KL散度是用来度量两个概率分布相似度的指标。假设对随机变量 <span class="math notranslate nohighlight">\(\xi\)</span> 存在两个概率分布 <span class="math notranslate nohighlight">\(P\)</span>、<span class="math notranslate nohighlight">\(Q\)</span>，定义从 <span class="math notranslate nohighlight">\(P\)</span> 到 <span class="math notranslate nohighlight">\(Q\)</span> 的KL散度为
$<span class="math notranslate nohighlight">\(
\mathbb{D}_{\mathrm{KL}}(P \| Q)=\sum_i P(i) \ln \left(\frac{P(i)}{Q(i)}\right) \quad\text{或}\quad \int_{-\infty}^{\infty} p(\mathbf{x}) \ln \left(\frac{p(\mathbf{x})}{q(\mathbf{x})}\right) \mathrm{~d} \mathbf{x}
\)</span>$</p>
<p>可以证明，KL散度具有非负性。以离散形式为例：根据Jensen’s不等式，</p>
<div class="math notranslate nohighlight">
\[
    \sum_{i=1}^n \lambda_i f\left(x_i\right) \leq f\left(\sum_{i=1}^n \lambda_i x_i\right), \quad\sum_{i=1}^n \lambda_i=1
\]</div>
<p>并且有 <span class="math notranslate nohighlight">\(\sum_i P(i)=1\)</span>、<span class="math notranslate nohighlight">\(\sum_i Q(i)=1\)</span></p>
<div class="math notranslate nohighlight">
\[
\sum_i P(i) \ln \left(\frac{Q(i)}{P(i)}\right) \leq \ln\left(\sum_i P(i)\cdot \frac{Q(i)}{P(i)} \right)=\ln\left(\sum_i Q(i)\right)=\ln(1)=0
\]</div>
<div class="math notranslate nohighlight">
\[
    \mathbb{D}_{\mathrm{KL}}(P \| Q)=-\sum_i P(i) \ln \left(\frac{Q(i)}{P(i)}\right) \geq 0
\]</div>
<p>当且仅当<span class="math notranslate nohighlight">\(P=Q\)</span>时取等号。</p>
<p>根据KL散度的非负性，可以知道 <span class="math notranslate nohighlight">\(F(b)-F_H=D_{KL}(b \| P)\geq 0\)</span>，即变分自由能的最小值为Helmholtz自由能，此时分布 <span class="math notranslate nohighlight">\(b(x)=P(x)\)</span>。</p>
<p>为了求解自由能，我们首先要给定 <span class="math notranslate nohighlight">\(b(x)\)</span> 的一个具体形式。接下来两个小节分别给出了 <span class="math notranslate nohighlight">\(b(x)\)</span> 的两种近似：Mean-Field Approximation和Bethe Approximation。</p>
</section>
<section id="mean-field-approximation">
<h2>三、Mean-Field Approximation<a class="headerlink" href="#mean-field-approximation" title="Permalink to this headline">#</a></h2>
<p>Mean-Field Approximation是假设该分布由互相独立的自旋格点 <span class="math notranslate nohighlight">\(x_i\in\{+1,-1\}\)</span> 组成，其均值即磁化强度为
$<span class="math notranslate nohighlight">\(
m_i=(+1)\times \frac{1+m_{i}(+1)}{2}+(-1)\times \frac{1+m_{i}(-1)}{2}
\)</span><span class="math notranslate nohighlight">\(
因此可以用 \)</span>m_i<span class="math notranslate nohighlight">\( 将单个格点的分布 \)</span>b_i<span class="math notranslate nohighlight">\( 参数化：
\)</span><span class="math notranslate nohighlight">\(
b_i(x_i)=\frac{1+m_ix_i}{2}
\)</span><span class="math notranslate nohighlight">\(
由于各个格点是相互独立的，系统的总分布就等于各个格点的分布相乘，因此系统的Mean-Field Approximation分布为
\)</span><span class="math notranslate nohighlight">\(
b_{MF}=\prod_ib_i(x_i)=\prod_i\frac{1+m_ix_i}{2}
\)</span><span class="math notranslate nohighlight">\(
在此近似下，变分内能为
\)</span>$
\begin{aligned}
U_{M F} &amp; =\sum_{\boldsymbol{x}} b_{M F}(\boldsymbol{x}) E(\boldsymbol{x}) \
&amp; =\sum_{\boldsymbol{x}} \prod_i b_i\left(x_i\right)\left(-\sum_a J_a \prod_{i \in \partial a} x_i\right) \
&amp; = -\sum_a J_a \left[\sum_{\boldsymbol{x}} \prod_i b_i\left(x_i\right)\prod_{i \in \partial a} x_i \right]\</p>
<p>\end{aligned}
$<span class="math notranslate nohighlight">\(
注意到 \)</span>x_i<span class="math notranslate nohighlight">\( 是相互独立的，接下来的操作相当于是 \)</span>\langle ab \rangle=\langle a \rangle\langle b \rangle<span class="math notranslate nohighlight">\(，其中 \)</span>a<span class="math notranslate nohighlight">\(、\)</span>b<span class="math notranslate nohighlight">\( 相互独立
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
U_{M F} &amp; = -\sum_a J_a \left[\sum_{\boldsymbol{x}} \prod_i b_i\left(x_i\right)\prod_{i \in \partial a} x_i \right]\\
&amp; = -\sum_a J_a \prod_{i \in \partial a}\left[\sum_{\boldsymbol{x}} \prod_i b_i\left(x_i\right) x_i \right] \\
&amp; =-\sum_a J_a \prod_{i \in \partial a} m_i,
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
变分熵为
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
H_{M F} &amp; =-\sum_x b_{M F}(x) \ln b_{M F}(x) \\
&amp; =-\sum_x \prod_j \frac{1+m_j x_j}{2} \ln \prod_i \frac{1+m_i x_i}{2} \\
&amp; =-\sum_i \sum_x \prod_j \frac{1+m_j x_j}{2} \ln \frac{1+m_i x_i}{2} \\
&amp; =-\sum_i \sum_{x_i} \sum_{x \backslash x_i} \prod_{j(\neq i)} \frac{1+m_j x_j}{2} \frac{1+m_i x_i}{2} \ln \frac{1+m_i x_i}{2} \\
&amp; =-\sum_i \sum_{x_i} \frac{1+m_i x_i}{2} \ln \frac{1+m_i x_i}{2} \\
&amp; =\sum_i S_i,
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
其中，
\)</span><span class="math notranslate nohighlight">\(
\sum_{x \backslash x_i} \prod_{j(\neq i)} \frac{1+m_j x_j}{2}=\sum_{x \backslash x_i}b_{MF\backslash x_i}=1
\)</span><span class="math notranslate nohighlight">\(
即相当于去掉格点 \)</span>i<span class="math notranslate nohighlight">\( 后的系统的总分布，由于各格点相互独立，此时系统的分布仍是归一化的。\)</span>S_i<span class="math notranslate nohighlight">\( 是单个自旋变量的熵
\)</span><span class="math notranslate nohighlight">\(
S_i=-k_B\sum_ip_i\ln p_i=- \sum_{x_i} \frac{1+m_i x_i}{2} \ln \frac{1+m_i x_i}{2}
\)</span><span class="math notranslate nohighlight">\(
式中，已令 \)</span>\beta=1<span class="math notranslate nohighlight">\(，因此 \)</span>k_B=\frac{1}{\beta}=1<span class="math notranslate nohighlight">\(，\)</span>p_i<span class="math notranslate nohighlight">\( 在此处是Mean-Field Approximation下的 \)</span>b_i$。</p>
<p>因此变分自由能为
$<span class="math notranslate nohighlight">\(
\begin{aligned}
F_{M F} &amp; =U_{M F}-H_{M F} \\
&amp; =-\sum_a J_a \prod_{i \in \partial a} m_i+\sum_i \sum_{x_i} \frac{1+m_i x_i}{2} \ln \frac{1+m_i x_i}{2}
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
令变分自由能取极值
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
\frac{\partial F_{M F}}{\partial m_i} &amp; =-\sum_a J_a \prod_{j \in \partial a \backslash i} m_j+\sum_{x_i} \frac{x_i}{2} \ln \frac{1+m_i x_i}{2}+\frac{x_i}{2} \\
&amp; =-\sum_a J_a \prod_{j \in \partial a \backslash i} m_j+\frac{1}{2} \ln \frac{1+m_i}{1-m_i}=0
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
即解
\)</span><span class="math notranslate nohighlight">\(
\ln \frac{1+m_i}{1-m_i}=2\sum_a J_a \prod_{j \in \partial a \backslash i} m_j=2A
\)</span><span class="math notranslate nohighlight">\(
由
\)</span><span class="math notranslate nohighlight">\(
\frac{1+m_i}{1-m_i}=e^{2A}\quad \Longrightarrow\quad m_i=\frac{e^{2A}-1}{e^{2A}+1}=\frac{e^{A}-e^{-A}}{e^{A}+e^{-A}}
\)</span><span class="math notranslate nohighlight">\(
即
\)</span><span class="math notranslate nohighlight">\(
m_i=\tanh \left(\sum_{a \in \partial i} J_a \prod_{j \in \partial a \backslash i} m_j\right)
\)</span><span class="math notranslate nohighlight">\(
这是一个迭代方程，将其迭代到不动点即可解出 \)</span>m_i$ 并找到此时对应的真实分布</p>
</section>
<section id="bethe-approximation">
<h2>四、Bethe Approximation<a class="headerlink" href="#bethe-approximation" title="Permalink to this headline">#</a></h2>
<section id="id4">
<h3>4.1 Bethe Approximation与信念传播算法<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>注意到Mean-Field Approximation要求各个格点之间完全相互独立，这只能在温度比较高的时候实现，对于温度较低的情况，必须要考虑格点之间的关联。本节中的Bethe Approximation就引入了格点间的部分关联。</p>
<p>仍然使用如下的分布
$<span class="math notranslate nohighlight">\(
P(\boldsymbol{x})=\frac{e^{-\beta E(x)}}{Z} \qquad E(\boldsymbol{x})=-\sum_a J_a \prod_{i \in \partial a} x_i
\)</span><span class="math notranslate nohighlight">\(
为了更好地在因子图中表示，我们首先进行一个变量替换，令
\)</span><span class="math notranslate nohighlight">\(
f_a(\boldsymbol{x}_a)=e^{J_a \prod_{i \in \partial a} x_i}
\)</span><span class="math notranslate nohighlight">\(
\)</span>f_a(\boldsymbol{x}_a)<span class="math notranslate nohighlight">\( 表示一个相互作用 \)</span>a<span class="math notranslate nohighlight">\(，其中 \)</span>\boldsymbol{x}_a<span class="math notranslate nohighlight">\( 表示参与该相互作用的所有自旋变量。同样令 \)</span>\beta=1<span class="math notranslate nohighlight">\(，因此
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
&amp; P(\boldsymbol{x})=\frac{1}{Z} \prod_a f_a\left(\boldsymbol{x}_a\right) \\
&amp; E(\boldsymbol{x})=-\sum_a \ln f_a\left(\boldsymbol{x}_a\right) 
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
显然，此时分布 \)</span>P(x)$ 是因子连乘的形式，用因子图表示为</p>
<p><img alt="" src="https://images.cnblogs.com/cnblogs_com/blogs/779311/galleries/2257667/o_221226125622_%E8%B4%9D%E8%92%82%E8%BF%91%E4%BC%BC%E7%9A%84%E5%9B%A0%E5%AD%90%E5%9B%BE.png" /></p>
<p>这里variable node是表示自旋的变量节点，function node是表示相互作用的功能节点。对这个因子图进行区域划分，每一个区域都要将与其中的功能节点相连的所有变量节点都包含在里面。上图中的黄色虚线圈出来的不能算作一个区域，因为与功能节点A相连的变量节点2没有被包含在其中。</p>
<p>对于一个区域 <span class="math notranslate nohighlight">\(R\)</span>，我们可以计算其内部的变分内能和变分熵：
$<span class="math notranslate nohighlight">\(
\begin{aligned}
&amp; E_R\left(x_R\right)=-\sum_{a \in R} \ln f_a\left(\boldsymbol{x}_a\right) \\
&amp; U_R\left(b_R\right)=\sum_{\boldsymbol{x}_R} b_R\left(\boldsymbol{x}_R\right) E_R\left(\boldsymbol{x}_R\right) \\
&amp; H_R\left(b_R\right)=-\sum_{\boldsymbol{x}_R} b_R\left(\boldsymbol{x}_R\right) \ln b_R\left(\boldsymbol{x}_R\right)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
 然后将各个区域的变分内能和变分熵相加，即
\)</span><span class="math notranslate nohighlight">\(
\begin{gathered}
U_{\mathcal{R}}=\sum_{R \in \mathcal{R}} C_R U_R\left(b_R\right)\\
H_{\mathcal{R}}=\sum_{R \in \mathcal{R}} C_R H_R\left(b_R\right)
\end{gathered}
\)</span><span class="math notranslate nohighlight">\(
其中，\)</span>\mathcal{R}<span class="math notranslate nohighlight">\( 是所有区域的集合，\)</span>C_R<span class="math notranslate nohighlight">\( 是用于对区域进行计数的变量，满足
\)</span><span class="math notranslate nohighlight">\(
\begin{gathered}
\sum_{R \in \mathcal{R}} \mathbb{I}[a \in R] C_R=1, \forall a \\
\sum_{R \in \mathbb{R}} \mathbb{I}[i \in R] C_R=1, \forall i
\end{gathered}
\)</span><span class="math notranslate nohighlight">\(
\)</span>\mathbb{I}[a \in R]<span class="math notranslate nohighlight">\( 表示如果功能节点 \)</span>a<span class="math notranslate nohighlight">\( 在区域 \)</span>R<span class="math notranslate nohighlight">\( 中，则 \)</span>C_R=1<span class="math notranslate nohighlight">\(，否则 \)</span>C_R=0<span class="math notranslate nohighlight">\(；同理，\)</span>\mathbb{I}[i \in R]<span class="math notranslate nohighlight">\( 表示如果变量节点 \)</span>i<span class="math notranslate nohighlight">\( 在区域 \)</span>R<span class="math notranslate nohighlight">\( 中，则 \)</span>C_R=1<span class="math notranslate nohighlight">\(，否则 \)</span>C_R=0$。</p>
<p><span class="math notranslate nohighlight">\(\mathbb{I}[a \in R]\)</span> 与 <span class="math notranslate nohighlight">\(C_R\)</span> 相乘再求和后等于 <span class="math notranslate nohighlight">\(1\)</span> 表示节点 <span class="math notranslate nohighlight">\(a\)</span> 只被考虑了一次，因此上式对于 <span class="math notranslate nohighlight">\(C_R\)</span> 的约束实际上是要求所有的变量节点和功能节点在求和时只被考虑一次，这是就划分区域的要求。</p>
<p>Bethe Approximation划分区域的方式如下图所示</p>
<p><img alt="" src="https://images.cnblogs.com/cnblogs_com/blogs/779311/galleries/2257667/o_221226132342_%E8%B4%9D%E8%92%82%E8%BF%91%E4%BC%BC%E7%9A%84%E5%88%92%E5%88%86%E5%8C%BA%E5%9F%9F%E7%9A%84%E6%96%B9%E5%BC%8F.png" /></p>
<p>划分的区域有两种，一种称作“大区域”，是包含一个功能节点以及所有与其相连的变量节点的区域；另一种称作“小区域”，只包含一个变量节点。大区域的计数设为 <span class="math notranslate nohighlight">\(1\)</span>，小区域的计数设为 <span class="math notranslate nohighlight">\(1-d_i\)</span>，其中 <span class="math notranslate nohighlight">\(d_i\)</span> 是变量节点 <span class="math notranslate nohighlight">\(i\)</span> 参与的功能节点的数量，即
$<span class="math notranslate nohighlight">\(
C_{R_{L}}=1,\quad C_{R_{S}}=1-d_i
\)</span><span class="math notranslate nohighlight">\(
这种划分方式和计数方式很自然地满足了上面对于 \)</span>C_R<span class="math notranslate nohighlight">\( 的两条约束：对于第一条（针对功能节点的）约束，只有大区域中有功能节点参与了求和，并且对于每个功能节点 \)</span>a<span class="math notranslate nohighlight">\(，当其包含在某个区域 \)</span>R<span class="math notranslate nohighlight">\( 中使得 \)</span>\mathbb{I}[a \in R]=1<span class="math notranslate nohighlight">\( 时，都有且仅有这一个区域的计数 \)</span>C_{R_L}=1<span class="math notranslate nohighlight">\(；对于第二条（针对变量节点的）约束，每个变量节点 \)</span>i<span class="math notranslate nohighlight">\( 在其参与的 \)</span>d_i<span class="math notranslate nohighlight">\( 个大区域（功能节点）中使得 \)</span>\mathbb{I}[a \in R]=1,,C_{R_{L}}=1<span class="math notranslate nohighlight">\(，并且使得其自身所在的小区域 \)</span>\mathbb{I}[a \in R]=1,,C_{R_{S}}=1-d_i<span class="math notranslate nohighlight">\(，所有大区域的求和为 \)</span>d_i<span class="math notranslate nohighlight">\(，只有一个小区域参与了求和为 \)</span>1-d_i<span class="math notranslate nohighlight">\(，因此总的求和为 \)</span>1$。</p>
<p>Bethe Approximation划分区域后，只考虑各个区域（主要指大区域）内部的相互作用，不考虑区域与区域间的相互作用，实际上是一个只考虑最近邻的相互作用的模型。</p>
<p>根据以上划分的区域，变分内能为
$$
\begin{aligned}
U_{\text {Bethe }}= &amp;\sum_{R \in \mathcal{R}} C_R U_R\left(b_R\right)=\sum_{R \in \mathcal{R}} C_R\sum_{\boldsymbol{x}_R} b_R\left(\boldsymbol{x}_R\right) E_R\left(\boldsymbol{x}<em>R\right)\
=&amp; \sum_a\sum</em>{x_a} b_a\left(\boldsymbol{x}<em>a\right) \left[-\sum</em>{a \in R} \ln f_a\left(\boldsymbol{x}<em>a\right)\right] \
=&amp;-\sum_a \sum</em>{x_a} b_a\left(\boldsymbol{x}_a\right) \ln f_a\left(\boldsymbol{x}_a\right) \</p>
<p>\end{aligned}
$<span class="math notranslate nohighlight">\(
这里由于哈密顿量没有外场，实际上只有大区域贡献了内能，因此第一行中的求和下标 \)</span>R\in\mathcal{R}<span class="math notranslate nohighlight">\( 有 \)</span>a<span class="math notranslate nohighlight">\( 个，并且每个大区域中只有一个功能节点，第二行中的求和下标 \)</span>a\in R<span class="math notranslate nohighlight">\( 实际上只对一个 \)</span>a<span class="math notranslate nohighlight">\( 求和，\)</span>C_R=C_{R_L}=1$。如果哈密顿量是具有外场的形式，那么求Bethe内能时也需要考虑小区域的作用。</p>
<p>变分熵为（大区域和小区域分别计算后求和）
$<span class="math notranslate nohighlight">\(
\begin{aligned}
H_{\text {Bethe }}= &amp;\sum_{R \in \mathcal{R}} C_R H_R\left(b_R\right)=\sum_{R \in \mathcal{R}} C_R \left[-\sum_{\boldsymbol{x}_R} b_R\left(\boldsymbol{x}_R\right) \ln b_R\left(\boldsymbol{x}_R\right)\right]\\
=&amp;-\sum_aC_{R_L}\sum_{\boldsymbol{x}_a} b_a\left(\boldsymbol{x}_a\right) \ln b_a\left(\boldsymbol{x}_a\right)-\sum_iC_{R_S}\sum_{\boldsymbol{x}_i} b_i\left(\boldsymbol{x}_i\right) \ln b_i\left(\boldsymbol{x}_i\right) \\
=&amp; -\sum_a \sum_{x_a} b_a\left(\boldsymbol{x}_a\right) \ln b_a\left(\boldsymbol{x}_a\right)+\sum_i\left(d_i-1\right) \sum_{x_i} b_i\left(x_i\right) \ln b_i\left(x_i\right) 
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
因此变分自由能为
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
F_{\text {Bethe }}= &amp; \; U_{\text {Bethe }}-H_{\text {Bethe }}\\
= &amp; -\sum_a \sum_{x_a} b_a\left(\boldsymbol{x}_a\right) \ln f_a\left(\boldsymbol{x}_a\right)+\sum_a \sum_{x_a} b_a\left(\boldsymbol{x}_a\right) \ln b_a\left(\boldsymbol{x}_a\right) \\
&amp;-\sum_i\left(d_i-1\right) \sum_{x_i} b_i\left(x_i\right) \ln b_i\left(x_i\right)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
在这里我们对变分自由能取机制时存在一些约束：
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
&amp; \sum_{x_i} b_i\left(x_i\right)=1, \forall i \\
&amp; \sum_{\boldsymbol{x}_a} b_a\left(\boldsymbol{x}_a\right)=1, \forall a \\
&amp; \sum_{\boldsymbol{x}_a / x_i} b_a\left(\boldsymbol{x}_a\right)=b_i\left(x_i\right), \forall i, a
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
前两条是归一化条件，第三条则是边际的一致性条件，即如果一个变量节点 \)</span>i<span class="math notranslate nohighlight">\( 参与了功能节点 \)</span>a<span class="math notranslate nohighlight">\(，那么参与功能节点 \)</span>a<span class="math notranslate nohighlight">\( 的除了 \)</span>i<span class="math notranslate nohighlight">\( 以外的所有变量节点的分布求和后等于 \)</span>i$ 的分布。</p>
<p>因此用拉格朗日乘子法求条件极值时首先构造Lagrangian
$<span class="math notranslate nohighlight">\(
\begin{aligned}
L= &amp; -\sum_a \sum_{\boldsymbol{x}_a} b_a\left(\boldsymbol{x}_a\right) \ln f_a\left(\boldsymbol{x}_a\right)+\sum_a \sum_{\boldsymbol{x}_a} b_a\left(\boldsymbol{x}_a\right) \ln b_a\left(\boldsymbol{x}_a\right) \\
&amp;-\sum_i\left(d_i-1\right) \sum_{x_i} b_i\left(x_i\right) \ln b_i\left(x_i\right)\\
&amp;+\sum_i \lambda_i\left(\sum_{x_i} b_i\left(x_i\right)-1\right)+\sum_a \lambda_a\left(\sum_{\boldsymbol{x}_a} b_a\left(\boldsymbol{x}_a\right)-1\right)\\
&amp;+\sum_{i, a} \sum_{x_i} \rho_{i, a}\left(x_i\right)\left(\sum_{\boldsymbol{x}_a / x_i} b_a\left(\boldsymbol{x}_a\right)-b_i\left(x_i\right)\right)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
令 \)</span>\frac{\partial L}{\partial b_a}=0<span class="math notranslate nohighlight">\(，得
\)</span><span class="math notranslate nohighlight">\(
\hat{b}_a\left(\boldsymbol{x}_a\right)=f_a\left(\boldsymbol{x}_a\right) \exp \left[\lambda_a-1+\sum_{i} \rho_{i, a}\left(x_i\right)\right]
\)</span><span class="math notranslate nohighlight">\(
令 \)</span>\frac{\partial L}{\partial b_i}=0<span class="math notranslate nohighlight">\(，得
\)</span><span class="math notranslate nohighlight">\(
\hat{b}_i\left(x_i\right)=\exp \left[\frac{1}{d_i-1}\left(1-\lambda_i+\sum_{a } \rho_{i, a}\left(x_i\right)\right)\right]
\)</span>$
这两个解来自于文献[2]和[5]，我自己还没有求解</p>
<p>我们定义从把 <span class="math notranslate nohighlight">\(a\)</span> 节点拿掉后 <span class="math notranslate nohighlight">\(i\)</span> 节点传递给 <span class="math notranslate nohighlight">\(a\)</span> 的“消息”为（文献[1]、[2]中都提到这个定义，但是这里采用的解释来自文献[4]）
$<span class="math notranslate nohighlight">\(
P_{i \rightarrow a}\equiv e^{\rho_{i, a}\left(x_i\right)}=\frac{1}{Z_{i\to a}}\prod_{b\in i\backslash a}P_{b\to i}
\)</span><span class="math notranslate nohighlight">\(
因此
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
\hat{b}_a\left(\boldsymbol{x}_a\right)&amp;=f_a\left(\boldsymbol{x}_a\right) \exp \left[\lambda_a-1+\sum_{i\in\partial a} \rho_{i, a}\left(x_i\right)\right]\\
&amp;=e^{\lambda_a-1}f_a\left(\boldsymbol{x}_a\right)\exp \left[\sum_{i\in\partial a} \ln P_{i \rightarrow a}\left(x_i\right)\right]\\
&amp;=e^{\lambda_a-1}f_a\left(\boldsymbol{x}_a\right)\prod_{i\in\partial a}\exp \left[\ln P_{i \rightarrow a}\left(x_i\right)\right]\\
&amp;=e^{\lambda_a-1}f_a\left(\boldsymbol{x}_a\right)\prod_{i\in\partial a} P_{i \rightarrow a}\left(x_i\right)
\end{aligned}
\)</span>$</p>
<p>即
$<span class="math notranslate nohighlight">\(
\hat{b}_a\left(\boldsymbol{x}_a\right)\propto f_a\left(\boldsymbol{x}_a\right)\prod_{i\in\partial a} P_{i \rightarrow a}\left(x_i\right)
\)</span>$</p>
<p>再定义从节点 <span class="math notranslate nohighlight">\(a\)</span> 传出到 <span class="math notranslate nohighlight">\(i\)</span> 的“消息”为
$<span class="math notranslate nohighlight">\(
P_{a\to i}\equiv\frac{\hat{b}_i\left(x_i\right)}{P_{i\to a}}
\)</span><span class="math notranslate nohighlight">\(
据文献[4]所说，对上式进行一些操作后可以将 \)</span>\hat{b}<em>i(x_i)<span class="math notranslate nohighlight">\( 写为
\)</span><span class="math notranslate nohighlight">\(
\hat{b}_i\left(x_i\right) \propto \prod_{a \in \partial i} P_{a \rightarrow i}\left(x_i\right)
\)</span><span class="math notranslate nohighlight">\(
这一步具体怎么操作还没搞明白。并且，有可能是根据上面 \)</span>P</em>{a\to i }<span class="math notranslate nohighlight">\( 的定义和边际的一致性约束条件可以得到
\)</span><span class="math notranslate nohighlight">\(
P_{a \rightarrow i}\left(x_i\right)=\sum_{\boldsymbol{x}_j: j \in \partial a \backslash i} f_a\left(\boldsymbol{x}_a\right) \prod_{j \in \partial a \backslash i} P_{j \rightarrow a}\left(x_j\right)
\)</span>$
这一步现在也还不理解。</p>
<p>总之，到这里，我们得到了信念传播的迭代方程。</p>
<p><span class="math notranslate nohighlight">\(\quad \)</span></p>
<p><strong>本节用到的参考文献：</strong>[1]~[7]</p>
<p>文献[2]中有关于本节的较为详细和深入的内容，为整理本节的笔记提供了很大的帮助</p>
</section>
<section id="id5">
<h3>4.2 一个例子：Bethe Approximation在树状因子图中是精确的<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>对于如下图所示的一个无环的树状因子图（从任意一个节点出发无法回到自身节点），对于这类因子图表示的网络，只存在最近邻相互作用，因此Bethe Approximation是精确的。</p>
<p><img alt="" src="C:%5CUsers%5Clyhsy%5CPictures%5CTypora%5C%E5%8F%98%E5%88%86%E5%B9%B3%E5%9D%87%E5%9C%BA%5Cimage-20221227171223167.png" /></p>
<p>对于该因子图，其联合概率分布可以拆分为
$<span class="math notranslate nohighlight">\(
p\left(x_1, x_2, x_3, x_4\right)=\frac{1}{Z} f_A\left(x_1, x_2\right) f_B\left(x_2, x_3, x_4\right) f_C\left(x_4\right)
\)</span>$
我们考虑第二个变量节点，即下图中红色的节点</p>
<p><img alt="" src="https://images.cnblogs.com/cnblogs_com/blogs/779311/galleries/2257667/o_221227092426_BP%E4%B8%BE%E4%BE%8B%E5%B8%A6%E6%B3%A8%E9%87%8A.png" /></p>
<p>根据上面得到的迭代方程
$<span class="math notranslate nohighlight">\(
b_i\left(x_i\right) \propto \prod_{a \in \partial i} P_{a \rightarrow i}\left(x_i\right), \quad P_{a \rightarrow i}\left(x_i\right)=\sum_{\boldsymbol{x}_j: j \in \partial a \backslash i} f_a\left(\boldsymbol{x}_a\right) \prod_{j \in \partial a \backslash i} P_{j \rightarrow a}\left(x_j\right)
\)</span><span class="math notranslate nohighlight">\(
则
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
b_i\left(x_2\right) &amp; \propto P_{A \rightarrow 2}\left(x_2\right) P_{B \rightarrow 2}\left(x_2\right) \\
&amp; \propto\left(\sum_{x_1} f_A\left(x_1, x_2\right) P_{1 \rightarrow A}\left(x_1\right)\right)\left(\sum_{x_3, x_4} f_B\left(x_2, x_3, x_4\right) P_{3 \rightarrow B}\left(x_3\right) P_{4 \rightarrow B}\left(x_4\right)\right)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
注意到变量节点 \)</span>1<span class="math notranslate nohighlight">\( 和 \)</span>3<span class="math notranslate nohighlight">\( 都只参与了一个功能节点，因此 \)</span>P_{1 \rightarrow A}<span class="math notranslate nohighlight">\( 和 \)</span>P_{3 \rightarrow B}<span class="math notranslate nohighlight">\( 都等于 \)</span>1<span class="math notranslate nohighlight">\(。变量节点 \)</span>4<span class="math notranslate nohighlight">\( 参与了 \)</span>B<span class="math notranslate nohighlight">\(、\)</span>C<span class="math notranslate nohighlight">\( 两个功能节点，根据迭代方程
\)</span><span class="math notranslate nohighlight">\(
P_{i \rightarrow a}=\frac{1}{Z_{i\to a}}\prod_{b\in i\backslash a}P_{b\to i}
\)</span><span class="math notranslate nohighlight">\(
有
\)</span><span class="math notranslate nohighlight">\(
P_{4 \rightarrow B}=P_{C\to 4}(x_4)
\)</span><span class="math notranslate nohighlight">\(
再将 \)</span>P_{C\to 4}(x_4)<span class="math notranslate nohighlight">\( 放入迭代方程中，由于功能节点 \)</span>C<span class="math notranslate nohighlight">\( 只与 \)</span>4<span class="math notranslate nohighlight">\( 这一个变量节点相连，\)</span>P_{C\to 4}(x_4)=f_C(x_4)<span class="math notranslate nohighlight">\(。因此
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
b_i\left(x_2\right) &amp; \propto\left(\sum_{x_1} f_A\left(x_1, x_2\right) P_{1 \rightarrow A}\left(x_1\right)\right)\left(\sum_{x_3, x_4} f_B\left(x_2, x_3, x_4\right) P_{3 \rightarrow B}\left(x_3\right) P_{4 \rightarrow B}\left(x_4\right)\right)\\
&amp; \propto\left(\sum_{x_1} f_A\left(x_1, x_2\right)\right)\left(\sum_{x_1, x_4} f_B\left(x_2, x_3, x_4\right) P_{C \rightarrow 4}\left(x_4\right)\right) \\
&amp; \propto\left(\sum_{x_1} f_A\left(x_1, x_2\right)\right)\left(\sum_{x_3, x_4} f_B\left(x_2, x_3, x_4\right) f_C\left(x_4\right)\right) \\
&amp; \propto \sum_{x_1, x_3, x_4} f_A\left(x_1, x_2\right) f_B\left(x_2, x_3, x_4\right) f_C\left(x_4\right)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
注意到 \)</span>\sum_{x_1, x_3, x_4} f_A\left(x_1, x_2\right) f_B\left(x_2, x_3, x_4\right) f_C\left(x_4\right)<span class="math notranslate nohighlight">\( 正是因子图中变量节点 \)</span>a<span class="math notranslate nohighlight">\( 的边际概率，即我们想要的 \)</span>b_i(x_2)$ 的形式。</p>
<p>同样地，对于功能节点 <span class="math notranslate nohighlight">\(B\)</span>，有
$<span class="math notranslate nohighlight">\(
\begin{aligned}
b_a\left(x_B\right) &amp; \propto f_B\left(x_2, x_3, x_4\right) P_{2 \rightarrow B}\left(x_2\right) P_{3 \rightarrow B}\left(x_3\right) P_{4 \rightarrow B}\left(x_4\right) \\
&amp; \propto f_B\left(x_2, x_3, x_4\right)\left(P_{A \rightarrow 2}\left(x_2\right)\right)\left(P_{C \rightarrow 4}\left(x_4\right)\right) \\
&amp; \propto f_B\left(x_2, x_3, x_4\right)\left(\sum_{x_1} f_A\left(x_1, x_2\right)\right)\left(P_{B \rightarrow 2}\left(x_2\right) P_{B \rightarrow 3}\left(x_3\right)\right) \\
&amp; \propto f_B\left(x_2, x_3, x_4\right)\left(\sum_{x_1} f_A\left(x_1, x_2\right)\right)\left(f_C\left(x_4\right)\right) \\
&amp; \propto \sum_{x_1} f_A\left(x_1, x_2\right) f_B\left(x_2, x_3, x_4\right) f_C\left(x_4\right)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
这也是 \)</span>b_a\left(x_B\right)$ 的精确的形式。</p>
<p>类似地，我们可以证明，对于这个树状因子图中所有的 <span class="math notranslate nohighlight">\(b_i(x_i)\)</span> 和 <span class="math notranslate nohighlight">\(b_a(x_a)\)</span> 都是精确的。</p>
</section>
<section id="id6">
<h3>4.3 Bethe Approximation与空腔方法的等价性<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<p>接下来我们只考虑空腔概率 <span class="math notranslate nohighlight">\(P_{i\to a}\)</span>，将
$<span class="math notranslate nohighlight">\(
P_{a \rightarrow i}\left(x_i\right)=\sum_{\boldsymbol{x}_j: j \in \partial a \backslash i} f_a\left(\boldsymbol{x}_a\right) \prod_{j \in \partial a \backslash i} P_{j \rightarrow a}\left(x_j\right)
\)</span><span class="math notranslate nohighlight">\(
代入
\)</span><span class="math notranslate nohighlight">\(
P_{i \rightarrow a}=\frac{1}{Z_{i\to a}}\prod_{b\in i\backslash a}P_{b\to i}
\)</span><span class="math notranslate nohighlight">\(
并将 \)</span>f_a(x_a)<span class="math notranslate nohighlight">\( 的定义
\)</span><span class="math notranslate nohighlight">\(
f_a(\boldsymbol{x}_a)=e^{J_a \prod_{i \in \partial a} x_i}
\)</span><span class="math notranslate nohighlight">\(
一并代入，得
\)</span><span class="math notranslate nohighlight">\(
P_{i \rightarrow a}\left(x_i\right)=\frac{1}{Z_{i \rightarrow a}} \prod_{b \in \partial i \backslash a} \sum_{x_j: j \in \partial b \backslash i} e^{J_a \prod_{i \in \partial a} x_i} \prod_{j \in \partial b \backslash i} P_{j \rightarrow b}\left(x_j\right)
\)</span><span class="math notranslate nohighlight">\(
为了证明Bethe Approximation与空腔方法是等价的，我们先假设 \)</span>P_{j\to b}<span class="math notranslate nohighlight">\( 是一个空腔概率，根据[空腔方法](https://www.cnblogs.com/lyhspace/p/17003818.html)第二小节中的内容，若 \)</span>x_j\in{\pm 1}<span class="math notranslate nohighlight">\(，可以将其参数化为
\)</span><span class="math notranslate nohighlight">\(
P_{j\to b}(x_j)=\frac{1+m_{j\to b}x_j}{2}
\)</span>$
接下来只要能根据该假设得到空腔的磁化强度的迭代方程，即说明该假设是自洽的。</p>
<p>考虑 <span class="math notranslate nohighlight">\(x_i=+1\)</span> 时，令
$<span class="math notranslate nohighlight">\(
A_b^{+}=\sum_{x_j: j \in \partial b \backslash i} e^{J_b \prod_{j \in \partial b \backslash i} x_j} \prod_{j \in \partial b \backslash i} \frac{1+m_{j \rightarrow b} x_j}{2}
\)</span><span class="math notranslate nohighlight">\(
这里与[空腔方法](https://www.cnblogs.com/lyhspace/p/17003818.html)第二小节中对 \)</span>\prod_{i \in \partial a} \frac{1+\sigma_i m_{i \rightarrow a}}{2}<span class="math notranslate nohighlight">\( 进行展开处理的操作类似，经过这个trick后可以得到
\)</span><span class="math notranslate nohighlight">\(
A_b^{+}=\cosh J_b\left(1+\tanh J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}\right)
\)</span><span class="math notranslate nohighlight">\(
类似地，当 \)</span>x_i=-1<span class="math notranslate nohighlight">\( 时，可得
\)</span><span class="math notranslate nohighlight">\(
A_b^{-}=\cosh J_b\left(1-\tanh J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}\right)
\)</span><span class="math notranslate nohighlight">\(
根据空腔磁化强度的定义
\)</span><span class="math notranslate nohighlight">\(
m_{i\to a}=\sum_{x_i}x_iP_{i\to a}(x_i)=\sum_{x_i}x_i\frac{\exp\left[-\beta H_{i\to a}(x_i)\right]}{\sum_{x_i}\exp\left[-\beta H_{i\to a}(x_i)\right]}
\)</span><span class="math notranslate nohighlight">\(
注意到我们这里定义的 \)</span>A_b^\pm<span class="math notranslate nohighlight">\( 与[空腔方法](https://www.cnblogs.com/lyhspace/p/17003818.html)第三小节空腔磁化强度部分的 \)</span>\Lambda_{b\to i}^\pm<span class="math notranslate nohighlight">\( 一致，按照相同的步骤可得
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
m_{i \rightarrow a} 
&amp; =\frac{\prod_{b \in \partial i \backslash a} A_b^{+}-\prod_{b \in \partial i \backslash a} A_b^{-}}{\prod_{b \in \partial i \backslash a} A_b^{+}+\prod_{b \in \partial i \backslash a} A_b^{-}} \\
&amp; =\frac{\prod_{b \in \partial i \backslash a}\left(1+\prod_1 \tanh J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}\right)-\prod_{b \in \partial i \backslash a}\left(1-\tanh J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}\right)}{\prod_{b \in \partial i \backslash a}\left(1+\tanh J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}\right)+\prod_{b \in \partial i \backslash a}\left(1-\tanh J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}\right)}
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
令
\)</span><span class="math notranslate nohighlight">\(
\tanh u_{b \rightarrow i}=\tanh J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}
\)</span><span class="math notranslate nohighlight">\(
即得[空腔方法](https://www.cnblogs.com/lyhspace/p/17003818.html)第三小节中空腔磁化强度的迭代方程：
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
&amp;m_{i \rightarrow a}  =\tanh \left(\sum_{b \in \partial i \backslash a} u_{b \rightarrow i}\right) \\
&amp;\tanh u_{b \rightarrow i}  =\tanh J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}
\end{aligned}
\)</span>$
从这里可以看到，Bethe Approximation与空腔方法是等价的。</p>
</section>
<section id="bethe-approximationmean-field-approximation">
<h3>4.4 Bethe Approximation与Mean-Field Approximation<a class="headerlink" href="#bethe-approximationmean-field-approximation" title="Permalink to this headline">#</a></h3>
<p>Mean-Field Approximation是忽略自旋变量间的所有相互作用，Bethe Approximation考虑了最近邻的相互作用，因此Bethe Approximation是比Mean-Field Approximation更高一级的近似。一般来说，高一级的近似是可以退化到低一级的近似的。本节将展示Bethe Approximation如何退化到Mean-Field Approximation。</p>
<p>上一小节提到，Bethe Approximation与cavity method是等价的。因此我们继续从上一小节空腔的磁化强度出发，将 <span class="math notranslate nohighlight">\(\sum_{b \in \partial i \backslash a} u_{b \rightarrow i}\)</span> 改写为
$<span class="math notranslate nohighlight">\(
m_{i \rightarrow a}  =\tanh \left(\sum_{b \in \partial i} u_{b \rightarrow i}- u_{a\to i}\right)
\)</span><span class="math notranslate nohighlight">\(
根据 \)</span>m_i=\tanh\left( \sum_{b \in \partial i} u_{b \rightarrow i}\right)<span class="math notranslate nohighlight">\( （已令 \)</span>\beta=1<span class="math notranslate nohighlight">\(），可以将 \)</span>\sum_{b \in \partial i} u_{b \rightarrow i}<span class="math notranslate nohighlight">\( 反表示为 \)</span>\tanh^{-1}(m_i)$。</p>
<p>再利用
$<span class="math notranslate nohighlight">\(
\tanh (x+y)=\frac{\tanh x+\tanh y}{1+\tanh x \tanh y}
\)</span><span class="math notranslate nohighlight">\(
以及
\)</span><span class="math notranslate nohighlight">\(
\tanh u_{a \rightarrow i}  =\tanh J_a \prod_{j \in \partial a \backslash i} m_{j \rightarrow a}
\)</span><span class="math notranslate nohighlight">\(
可得
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
m_{i \rightarrow a} &amp; =\tanh \left(\sum_{b \in \partial i} u_{b \rightarrow i}-u_{a \rightarrow i}\right) \\
&amp; =\tanh \left(\tanh ^{-1}\left(m_i\right)-u_{a \rightarrow i}\right) \\
&amp; =\frac{m_i-\tanh \beta J_a \prod_{j \in \partial a \backslash i} m_{j \rightarrow a}}{1-m_i \tanh \beta J_a \prod_{j \in \partial a \backslash i} m_{j \rightarrow a}},
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
考虑一个 \)</span>i<span class="math notranslate nohighlight">\( 和 \)</span>j<span class="math notranslate nohighlight">\( 的二体相互作用，上式可以改写为两个迭代式：
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
&amp; m_{i \rightarrow j}=\frac{m_i-\tanh \beta J_{i j} m_{j \rightarrow i}}{1-m_i \tanh \beta J_{i j} m_{j \rightarrow i}} \\
&amp; m_{j \rightarrow i}=\frac{m_j-\tanh \beta J_{i j} m_{i \rightarrow j}}{1-m_j \tanh \beta J_{i j} m_{i \rightarrow j}}
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
将两个式子互相带入，可分别得到 \)</span>m_{i\to j}<span class="math notranslate nohighlight">\( 和 \)</span>m_{j\to i}<span class="math notranslate nohighlight">\( 关于 \)</span>m_i<span class="math notranslate nohighlight">\(、\)</span>m_j<span class="math notranslate nohighlight">\( 及 \)</span>J_{ij}<span class="math notranslate nohighlight">\( 的表达式，将其记为 \)</span>f<span class="math notranslate nohighlight">\(，即
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
m_{i \rightarrow j} &amp; =f\left(m_i, m_j, \tanh \beta J_{i j}\right) \\
m_{j \rightarrow i} &amp; =f\left(m_j, m_i, \tanh \beta J_{i j}\right) 
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
其中，
\)</span><span class="math notranslate nohighlight">\(
f(a, b, t) =\frac{1-t^2-\sqrt{\left(1-t^2\right)^2-4 t(a-b t)(b-a t)}}{2 t(b-a t)}
\)</span>$
（具体怎么算出来的，等以后再补充）</p>
<p>对于 <span class="math notranslate nohighlight">\(m_i=\tanh\left( \sum_{b \in \partial i} u_{b \rightarrow i}\right)\)</span>，根据（注意从这里开始不再忽略 <span class="math notranslate nohighlight">\(\beta\)</span>）
$<span class="math notranslate nohighlight">\(
\tanh u_{b \rightarrow i}  =\tanh\beta J_b \prod_{j \in \partial b \backslash i} m_{j \rightarrow b}
\)</span><span class="math notranslate nohighlight">\(
在二体相互作用中写为
\)</span><span class="math notranslate nohighlight">\(
\tanh u_{j \rightarrow i}  =m_{i \rightarrow j} \tanh \beta J_{ij}
\)</span><span class="math notranslate nohighlight">\(
其中，\)</span>m_{i \rightarrow j} =f\left(m_i, m_j, \tanh \beta J_{i j}\right)<span class="math notranslate nohighlight">\(。因此
\)</span><span class="math notranslate nohighlight">\(
u_{j \rightarrow i}  =\tanh^{-1}\Big[ f\left(m_i, m_j, \tanh \beta J_{i j}\right) \tanh \beta J_{ij}\Big]
\)</span><span class="math notranslate nohighlight">\(
磁化强度写为
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
m_i&amp;=\tanh\left( \sum_{j \in \partial i} u_{j \rightarrow i}\right)\\
&amp;=\tanh\left\{\sum_{j \in \partial i}\tanh^{-1}\big[ f\left(m_i, m_j, \tanh \beta J_{i j}\right) \tanh \beta J_{ij}\big]\right\}
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
考虑温度较高时，即 \)</span>\beta<span class="math notranslate nohighlight">\( 较小时，根据近似
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
&amp; \tanh ^{-1} x \approx x, \tanh x \approx x \\
&amp; (1+x)^a \approx 1+a x+\frac{1}{2} a(a-1) x^2
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
有
\)</span><span class="math notranslate nohighlight">\(
\begin{aligned}
&amp; \tanh \beta J_{i j}\approx \beta J_{i j} \\
&amp; \tanh^{-1}\big[ f\left(m_i, m_j, \tanh \beta J_{i j}\right) \tanh \beta J_{ij}\big]\approx\beta J_{ij}f\left(m_i, m_j, \beta J_{i j}\right)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
并且对 \)</span>f(a,b,t)<span class="math notranslate nohighlight">\( 做某种复杂的近似操作，可以得到
\)</span><span class="math notranslate nohighlight">\(
m_i=\tanh \left[\sum_{j \in \partial i}\left(\beta J_{i j} m_j-\beta^2 J_{i j}^2\left(1-m_j^2\right) m_i\right)\right]
\)</span><span class="math notranslate nohighlight">\(
这个方程称为“TAP方程”，会在之后的一章中详细介绍。如果温度足够高，\)</span>\beta^2<span class="math notranslate nohighlight">\( 也作为高阶小量忽视掉，则
\)</span><span class="math notranslate nohighlight">\(
m_i=\tanh \left(\beta\sum_{j \in \partial i} J_{i j} m_j\right)
\)</span>$
这就是我们在第三小节中用Mean-Field Approximation得到的结果。</p>
<p>从上面可以看到，Bethe Approximation在温度较高时可以退化为Mean-Field Approximation，因为高温实际上意味这自旋变量之间的相互作用减弱。</p>
</section>
<section id="id7">
<h3>4.5 平均场逆伊辛问题<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\( \quad\)</span></p>
<p><strong>4.4、4.5小节参考文献：</strong>[8]</p>
</section>
</section>
<section id="id8">
<h2>作业<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h2>
<section id="id9">
<h3>1. 关于树状图中Bethe Approximation对应的分布的问题<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h3>
<p>在本篇第四小节，我们使用对树状图划分区域的方式得到了Bethe自由能
$<span class="math notranslate nohighlight">\(
\begin{aligned}
F_{\text {Bethe }}
= &amp; -\sum_a \sum_{x_a} b_a\left(\boldsymbol{x}_a\right) \ln f_a\left(\boldsymbol{x}_a\right)+\sum_a \sum_{x_a} b_a\left(\boldsymbol{x}_a\right) \ln b_a\left(\boldsymbol{x}_a\right) \\
&amp;-\sum_i\left(d_i-1\right) \sum_{x_i} b_i\left(x_i\right) \ln b_i\left(x_i\right)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
实际上，根据以上结果，以及变分自由能的定义
\)</span><span class="math notranslate nohighlight">\(
F(b)=U(b)-H(b)
\)</span><span class="math notranslate nohighlight">\(
其中，\)</span>U(b)=\sum_x b(x) E(x) ,; H(b)=-\sum_x b(x) \ln b(x)$</p>
<p>我们可以直接总结出 <span class="math notranslate nohighlight">\(b(x)\)</span> 的形式为
$<span class="math notranslate nohighlight">\(
b_{B A}(\boldsymbol{x})=\frac{\prod_a b_a\left(\boldsymbol{x}_a\right)}{\prod_i b_i\left(x_i\right)^{d_i-1}}
\)</span>$
文献[2]中提到这是在文献[3]中提出的一个“广为人知”的结论，但是我目前还没有理解文献[3]中的内容，留待以后补充。</p>
<p>关于 <span class="math notranslate nohighlight">\(b_{BA}(x)\)</span>，有两个小题：(1) 证明 <span class="math notranslate nohighlight">\(b_{BA}(x)\)</span> 是归一化的；(2) 证明在无环的树状图中，<span class="math notranslate nohighlight">\(b_{BA}(x)\)</span> 是精确的</p>
</section>
<section id="belief-propagationsk-model-c-ij">
<h3>2. 用Belief Propagation求解SK model中的 <span class="math notranslate nohighlight">\(C_{ij}\)</span><a class="headerlink" href="#belief-propagationsk-model-c-ij" title="Permalink to this headline">#</a></h3>
</section>
<section id="bethe-approximationinverse-ising-problem">
<h3>3. 用Bethe Approximation求解inverse Ising problem<a class="headerlink" href="#bethe-approximationinverse-ising-problem" title="Permalink to this headline">#</a></h3>
</section>
</section>
<section id="id10">
<h2>参考文献<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h2>
<p>[1] Yedidia, Jonathan S., William T. Freeman, and Yair Weiss. “<a class="reference external" href="https://www.cs.huji.ac.il/course/2005/pmai/tirguls/TR2001-22.pdf">Understanding belief propagation and its generalizations.</a>” <em>Exploring artificial intelligence in the new millennium</em> 8.236-239 (2003): 0018-9448.</p>
<p>[2] Yedidia, Jonathan S., William T. Freeman, and Yair Weiss. “<a class="reference external" href="https://www.cs.princeton.edu/courses/archive/spring06/cos598C/papers/YedidaFreemanWeiss2004.pdf">Constructing free-energy approximations and generalized belief propagation algorithms.</a>” <em>IEEE Transactions on information theory</em> 51.7 (2005): 2282-2312.</p>
<p>[3] Cowell, Robert. “<a class="reference external" href="https://link.springer.com/chapter/10.1007/978-94-011-5014-9_2">Advanced inference in Bayesian networks.</a>” <em>Learning in graphical models</em>. Springer, Dordrecht, 1998. 27-49.</p>
<p>[4] Heskes, Tom. “<a class="reference external" href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=98a0dd903f0eea9fc35bd5f163563252c118ca60">On the uniqueness of loopy belief propagation fixed points.</a>” <em>Neural Computation</em> 16.11 (2004): 2379-2413.</p>
<p>[5] Yuille, Alan. “<a class="reference external" href="https://www.cs.jhu.edu/~ayuille/JHUcourses/VisionAsBayesianInference2020/10/BeliefPropagationMFT.pdf">Belief propagation, mean-field, and bethe approximations.</a>” <em>Dept. Stat., Univ. California, Los Angeles, Los Angeles, CA, USA, Tech. Rep</em> 4 (2010).</p>
<p>[6] Yedidia, Jonathan S., William T. Freeman, and Yair Weiss. “<a class="reference external" href="https://merl.com/publications/docs/TR2001-16.pdf">Bethe free energy, Kikuchi approximations, and belief propagation algorithms.</a>” <em>Advances in neural information processing systems</em> 13 (2001): 689.</p>
<p>[7] Eric P. Xing “<a class="reference external" href="https://www.cs.cmu.edu/~epxing/Class/10708-17/notes-17/10708-scribe-lecture12.pdf">Variational Inference: Loopy Belief Propagation</a>” Probabilistic Graphical Models (10-708, Spring 2017) Lecture notes, School of Computer Science, Carnegie Mellon University</p>
<p>[8] Ricci-Tersenghi, Federico. “<a class="reference external" href="https://arxiv.org/abs/1112.4814">The Bethe approximation for solving the inverse Ising problem: a comparison with other inference methods.</a>” <em>Journal of Statistical Mechanics: Theory and Experiment</em> 2012.08 (2012): P08015.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By 李宇豪<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>